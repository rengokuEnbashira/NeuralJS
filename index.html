<html>
  <head>
    <title>Neural Network</title>
    <script src="neural.js"></script>
  </head>
  <body >
    <div id="data" style="float:left;width:100%;">
      <div style="float:left;padding:20px;">
	<h4>input data</h4>
	<textarea id="input-data" rows=20 cols=50>
-0.12225064041715727,-0.07197465644410794
-0.938139025424614,-1.5023542133368966
-0.33043418358843457,1.0821375516914946
0.6079845631550613,0.4212114926564481
-0.23011148612192223,-1.1539569465115518
1.1563226579452959,1.0455074708966836
0.815531627663129,1.9293814189301108
-1.9130654234958753,-1.2363354345677169
-0.16833788195294908,-1.4060139966631509
0.19723146407116543,-1.4732116673321776
1.4408496321524673,-1.5000656711568312
0.6208579524347155,-0.23919767980917817
-1.6499379877449272,0.1993905030923142
-0.4827792649846767,-1.3443772537056877
-1.834297106188704,-1.7067930017640687
1.588410257613782,0.2578899554080105
-0.5757760500068629,0.062391702810254746
-1.6460314013848527,0.7689712161337074
-1.6531890482678957,-0.9733401705088021
1.4016918889838137,-0.34620610664443596
0.5737183127035062,1.7133220017584359
1.0863736280982215,-1.171054814517031
-1.0554250455581302,-1.6441519938936202
0.95464085854604,0.4303252282555139
1.5070772641151011,-0.6193319908054105
0.38407378412188864,1.2793359263357176
1.7030862629569663,-1.4363039346184614
0.9020535055438792,-1.0355859877134233
1.8746655815113864,1.4042697602258838
-1.458909340999579,-1.3230612934939332
-1.2030012541868942,1.318492501749466
0.1935585192721616,-1.5094154236302768
-0.6976924135251403,-0.7707200935394112
0.6121595497217966,1.9185682612084682
-1.2321063846856046,-1.3554268636932432
1.8205998602512254,-0.2862957822431147
1.976610019057368,1.659215590180294
-1.3672087787877056,0.9738313369052829
-1.523296998539604,-1.8137757253099256
-0.016337900107519232,-1.9748980353992023
0.3853432882566672,1.5974061009030835
1.1791265195693494,1.777473831997996
-0.5833481224180197,-1.9771469960211383
0.4499134250002905,-1.652433857220379
-1.8917869071205091,-1.759203002088869
0.06337615066181579,-1.0333781931370383
0.16088983465117268,0.9985102124615253
1.3560969395717128,-1.883761127910459
1.0909929473603515,1.1366050086531803
1.327594014363557,1.8265925253472264</textarea>
      </div>
      <div style="float:left;padding:20px;">
	<h4>output data</h4>
	<textarea id="output-data" rows=20 cols=25>
1.000000,0.000000
1.000000,0.000000
1.000000,0.000000
1.000000,0.000000
1.000000,0.000000
1.000000,0.000000
0.000000,1.000000
0.000000,1.000000
1.000000,0.000000
1.000000,0.000000
0.000000,1.000000
1.000000,0.000000
1.000000,0.000000
1.000000,0.000000
0.000000,1.000000
1.000000,0.000000
1.000000,0.000000
1.000000,0.000000
1.000000,0.000000
1.000000,0.000000
1.000000,0.000000
1.000000,0.000000
1.000000,0.000000
1.000000,0.000000
1.000000,0.000000
1.000000,0.000000
0.000000,1.000000
1.000000,0.000000
0.000000,1.000000
1.000000,0.000000
1.000000,0.000000
1.000000,0.000000
1.000000,0.000000
0.000000,1.000000
1.000000,0.000000
1.000000,0.000000
0.000000,1.000000
1.000000,0.000000
0.000000,1.000000
1.000000,0.000000
1.000000,0.000000
0.000000,1.000000
0.000000,1.000000
1.000000,0.000000
0.000000,1.000000
1.000000,0.000000
1.000000,0.000000
0.000000,1.000000
1.000000,0.000000
0.000000,1.000000</textarea>
      </div>
    </div>
    <div id="model-and-train" style="padding:20px;">
      <div style="float:left;padding:20px;">
	<h4>model</h4>
	<textarea id="model-details" rows=20 cols=50>
{
"layer1":{"inp":2,"out":5,"act_fun":"sigmoid"},
"layer2":{"inp":5,"out":2,"act_fun":"sigmoid"}
}
	</textarea>
      </div>
      <div style="float:left;padding:20px;">
	<h4>train</h4>
	<textarea id="train-details" rows=20 cols=50>
{
"loss" : "cross_entropy",
"maxIt": 1000,
"learning_rate" : 1
}
	</textarea>
      </div>
    </div>
    <button id="train_btn" onclick=train()>Train</button>
    <script>
      function train(){
	  var model = new neural_network();
	  var model_detail = document.getElementById("model-details").value;
	  model.from_string(model_detail);
	  console.log(model);

	  var inp_data = document.getElementById("input-data").value;
	  var out_data = document.getElementById("output-data").value;
	  var inp_set = new matrix();
	  var out_set = new matrix();
	  inp_set.from_string(inp_data);
	  out_set.from_string(out_data);
	  console.log(inp_set);
	  console.log(out_set);
	  
	  var train_detail = document.getElementById("train-details").value;
	  var train = JSON.parse(train_detail);
	  console.log(train);
	  model.train(inp_set,out_set,train["loss"],train["maxIt"],train["learning_rate"]);

	  var pred = model.predict(inp_set);
	  console.log(pred);
      }
    </script>
  </body>
</html>
